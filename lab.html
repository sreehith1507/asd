<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Lab Dashboard - AyurTrace</title>
	<link rel="stylesheet" href="styles.css" />
</head>
<body>
	<div class="topbar">
		<div class="brand">AyurTrace</div>
		<div class="navlinks">
			<a href="dashboard.html">Dashboard</a>
			<a href="farmer.html">Farmer</a>
			<a href="lab.html">Lab</a>
			<a href="verify.html">Verify Status</a>
		</div>
	</div>
	<div class="wrapper">
		<div class="hero">
			<div class="inner">
				<h2>Laboratory</h2>
				<p>View QA/QC results for batches, including moisture, pesticide, and DNA barcoding.</p>
			</div>
		</div>

		<div class="grid">
			<div class="card">
				<h3>Lab Identity</h3>
				<div class="info-grid">
					<div class="info-item"><b>Name</b><span>Swasthya Labs</span></div>
					<div class="info-item"><b>Accreditation</b><span>NABL ISO/IEC 17025</span></div>
					<div class="info-item"><b>Lab ID</b><span>LAB-IND-2217</span></div>
					<div class="info-item"><b>Contact</b><span>support@swasthyalabs.example</span></div>
				</div>
			</div>
			<div class="card">
				<h3>Recent Test Results</h3>
				<pre id="tests">[
{
	"batchId": "ASH-2025-0901",
	"moisturePct": 9.6,
	"pesticides": "Below LOQ",
	"dnaBarcode": "Withania somnifera confirmed",
	"testedAt": "2025-09-14T10:30:00Z"
}
]</pre>
			</div>
		</div>

		<div class="card">
			<h3>Upload Lab Report (PDF)</h3>
			<div class="row">
				<div class="half">
					<input type="file" id="pdfInput" accept="application/pdf" />
				</div>
				<div class="half" style="align-self:flex-end;">
					<button id="clearPdf" class="cta secondary" style="width:auto;">Remove File</button>
				</div>
			</div>
			<div class="info-grid" style="margin-top:10px;">
				<div class="info-item"><b>File Name</b><span id="pdfName">-</span></div>
				<div class="info-item"><b>Size</b><span id="pdfSize">-</span></div>
			</div>
			<div id="pdfViewer" style="margin-top:12px; height:520px; border-radius:12px; overflow:hidden; border:1px solid var(--border); background:#0e2e1f; display:none;"></div>
		</div>
	</div>

	<script>
	function formatBytes(bytes) { const u=['B','KB','MB','GB']; let i=0,v=bytes; while(v>=1024 && i<u.length-1){v/=1024;i++;} return `${v.toFixed(1)} ${u[i]}`; }
	document.getElementById('pdfInput').addEventListener('change', () => {
		const f = document.getElementById('pdfInput').files[0];
		if (!f) return;
		document.getElementById('pdfName').textContent = f.name;
		document.getElementById('pdfSize').textContent = formatBytes(f.size);
		const url = URL.createObjectURL(f);
		const viewer = document.getElementById('pdfViewer');
		viewer.style.display = 'block';
		viewer.innerHTML = `<iframe title=\"pdf\" src=\"${url}#view=FitH\" width=\"100%\" height=\"100%\" style=\"border:0\"></iframe>`;
		localStorage.setItem('labPdfName', f.name);
		localStorage.setItem('labPdfSize', f.size.toString());
		localStorage.setItem('labPdfUrl', url);
	});

	document.getElementById('clearPdf').addEventListener('click', () => {
		document.getElementById('pdfInput').value = '';
		document.getElementById('pdfName').textContent = '-';
		document.getElementById('pdfSize').textContent = '-';
		const viewer = document.getElementById('pdfViewer');
		viewer.style.display = 'none';
		viewer.innerHTML = '';
		localStorage.removeItem('labPdfName');
		localStorage.removeItem('labPdfSize');
		localStorage.removeItem('labPdfUrl');
	});

	// Load last uploaded (if any)
	(function initPdf(){
		const name = localStorage.getItem('labPdfName');
		const size = localStorage.getItem('labPdfSize');
		const url = localStorage.getItem('labPdfUrl');
		if (name && url) {
			document.getElementById('pdfName').textContent = name;
			document.getElementById('pdfSize').textContent = size ? (Number(size)/1024/1024).toFixed(2)+' MB' : '-';
			const viewer = document.getElementById('pdfViewer');
			viewer.style.display = 'block';
			viewer.innerHTML = `<iframe title=\"pdf\" src=\"${url}#view=FitH\" width=\"100%\" height=\"100%\" style=\"border:0\"></iframe>`;
		}
	})();
	</script>
	</div>
</body>
</html> 